<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
>


    <h:head>
        <title>BooksManagement</title>
    </h:head>
    <h:body>
    <h:form>
        <h3>CREATE</h3>
        <table class="order-table" id="addbook">
            <thead>
            <tr>
                <th class="order-table-header" scope="col">Author</th>
                <th class="order-table-header" scope="col">Name</th>
                <th class="order-table-header" scope="col">Title</th>
                <th class="order-table-header" scope="col">ISBN</th>
                <th class="order-table-header" scope="col">Yeor of publish</th>
                <th class="order-table-header" scope="col">Price</th>
                <th class="order-table-header" scope="col">Create</th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <h:inputText value="#{BookSite.surname}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.name}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.title}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.ISBN}">
                            <f:ajax event="blur"/>
                            <f:validateRegex pattern="\d{13}" />
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.year}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.price}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:commandButton value="add book">
                            <f:ajax listener="#{BookSite.addBook}" render="@all"/>
                        </h:commandButton>
                    </td>
                </tr>
            </tbody>
        </table>
    </h:form>
    <br/>
        <h3>READ and DELETE</h3>

        <table class="order-table" id="table">
            <thead>
            <tr>
                <th class="order-table-header" scope="col">Author</th>
                <th class="order-table-header" scope="col">Name</th>
                <th class="order-table-header" scope="col">Title</th>
                <th class="order-table-header" scope="col">ISBN</th>
                <th class="order-table-header" scope="col">Yeor of publish</th>
                <th class="order-table-header" scope="col">Price</th>
                <th class="order-table-header" scope="col">Delete</th>
                <th class="order-table-header" scope="col">Update</th>
            </tr>
            </thead>
            <tbody>

            <ui:repeat value="#{BookSite.books}" var="book">
                <tr>
                    <td>#{book.authorSurname}</td>
                    <td>#{book.authorName}</td>
                    <td>#{book.title}</td>
                    <td>#{book.ISBN}</td>
                    <td>#{book.publishYear}</td>
                    <td>#{book.price}</td>
                    <td>
                        <h:commandButton value="-">
                            <f:ajax listener="#{BookSite.removeBook(book)}" render="@all"/>
                        </h:commandButton>
                    </td>
                    <td>
                        <h:commandButton value="edit">
                            <f:ajax listener="#{BookSite.setUpdateBook(book)}" render="@all"/>
                        </h:commandButton>
                    </td>

                </tr>
            </ui:repeat>
            </tbody>
        </table>

        <h:form rendered="#{BookSite.renderUpdate}">
            <h3>UPDATE</h3>
            <table class="order-table" id="updateBook">
                <thead>
                <tr>
                    <th class="order-table-header" scope="col">Author</th>
                    <th class="order-table-header" scope="col">Name</th>
                    <th class="order-table-header" scope="col">Title</th>
                    <th class="order-table-header" scope="col">ISBN</th>
                    <th class="order-table-header" scope="col">Yeor of publish</th>
                    <th class="order-table-header" scope="col">Price</th>
                    <th class="order-table-header" scope="col">Create</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <h:inputText value="#{BookSite.surnameUpdate}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.nameUpdate}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.titleUpdate}">
                            <f:ajax event="blur"/>
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.ISBNUpdate}">
                            <f:ajax event="blur"/>
                            <f:validateRegex pattern="\d{13}" />
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.yearUpdate}">
                            <f:ajax event="blur"/>
                            <f:validateRegex pattern="\d{1,4}" />
                        </h:inputText>
                    </td>
                    <td>
                        <h:inputText value="#{BookSite.priceUpdate}">
                            <f:ajax event="blur"/>
                            <f:validateRegex pattern="\d+\.?\d*" />
                        </h:inputText>
                    </td>
                    <td>
                        <h:commandButton value="update book">
                            <f:ajax listener="#{BookSite.updateBook}" render="@all"/>
                        </h:commandButton>
                    </td>
                </tr>
                </tbody>
            </table>
        </h:form>


    </h:body>
</html>